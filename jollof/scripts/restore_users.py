from jollof.models import *
from pprint import pprint
from jollof.buy import Buy

def run():
    buyers = '''
1447143078674364 08136673932  
1610279619036452 08132400359 6.5243793,3.3792057
1206208349485929 08031991212  
1467210700021338 08175410053  
1497135920401362 07033843810  
1671702096173791 08131976306 6.5243793,3.3792057
1476092842511861 08164097019  
1534557909971656 08030907949 6.599333,3.363878
1773136582699569    
1531576446860738    
2101739983185575 08086419406 6.5243793,3.3792057\t6.4000468913954,5.6097006797791\t6.4000468913954,5.6097006797791
1670947126312254 08035302956 6.51332,3.377522\t6.5714,3.36759
1456552727725740 08012341234 6.5243793,3.3792057\t6.5243793,3.3792057
1498556673576789 08081087499  
1870948619587123 +2348081234567  
1208942465877374    
1554343837991544    
1543389759062354 08184209188 7.3928989,3.9067364
1568794893179120    
1567788883281676    
1366902413426979 08086903599 9.8791269,8.8744664\t9.9155047816624,8.8811588287354
1373677229408326 07033000108  
1613123562073529 07064409081 7.445944,3.894649\t8.17416,4.26234\t8.17416,4.26234\t7.441212,3.895604\t7.442835,3.902926\t7.443554,3.897832\t7.443217,3.897832\t6.5243793,3.3792057\t7.39689,3.920649\t7.443554,3.897832\t7.443554,3.897832\t7.401347,3.893143\t7.442369,3.897242\t6.50845,3.379297\t6.510162,3.376514
1856831137666217 07062359125 9.1024695,7.4975376
1428937823886580 08180871672 6.5251603716521,3.379282951355
1843792732297626 08000008888  
1637666849594117   6.457047,3.418388
1403958956391116    
1427680673953029 07034366179 6.5243793,3.3792057
1788619227833196 07068482288  
1741355649210370    
1591504750906387 07066223284 7.45073,3.90203\t7.45107,3.901125\t7.4416666666667,3.9\t7.4442371379431,3.9006643809518\t7.44315,3.900194
1409182282491864 08167621399 7.4008225,3.893848\t7.4008225,3.893848
1613628565378461    
1649046095127310 08060168868  
1266381593466145 08090738270  
1476590882423096    
1403542886400265   6.8333333333333,4.75
1595282240542629 08063412312 
1285852974859882 08033342173 7.439029,3.910502'''
    splitting = buyers.split('\n')
    pprint(splitting)
    for splitted in splitting:
        splits = splitted.split(' ')
        pprint(splits)
        pprint('Length of splits ' + str(len(splits)))
        if len(splits) <=1:
            continue
        fbid, phone_number, location_history = '', '', ''
        if len(splits) == 3:
            fbid = splits[0]
            phone_number = splits[1]
            location_history = splits[2]
        elif len(splits) == 4:
            fbid = splits[0]
            phone_number = splits[1]
            location_history = splits[2]
        elif len(splits) == 5:
            fbid = splits[0]
            phone_number = ''
            location_history = ''
        try:
            password = User.objects.make_random_password()
            pprint(password)
            user = User.objects.create_user(username=fbid, email=fbid+'@jollofbot.com', password=password)
            buy_obj = Buy()
            details = buy_obj.get_user_details(fbid)
            user.first_name = details['first_name']
            user.last_name = details['last_name']
            user.profile.user_type = 'b'
            user.profile.fbid = fbid
            user.profile.phone_number = phone_number
            user.profile.location_history = location_history
            user.save()
            pprint(fbid + ' created.')
        except Exception as e:
            pprint(e)
            pprint(fbid)
    pprint('DONE!')